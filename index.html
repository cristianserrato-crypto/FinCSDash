<!-- Define que este es un documento HTML5 moderno -->
<!DOCTYPE html>
<!-- Inicio de la etiqueta HTML, configurada en idioma espaÃ±ol -->
<html lang="es">
<head>
    <!-- Permite caracteres especiales como tildes y Ã± -->
    <meta charset="UTF-8">
    <!-- Asegura que la pÃ¡gina se vea bien en celulares (ajusta el ancho a la pantalla) -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- El tÃ­tulo que aparece en la pestaÃ±a del navegador -->
    <title>FinCSDash</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Estilos -->
    <!-- Conecta este archivo con la hoja de estilos CSS para que se vea bonito -->
    <link rel="stylesheet" href="css/styles.css">

    <!-- Google Identity -->
    <!-- Carga la librerÃ­a de Google para poder iniciar sesiÃ³n con Gmail -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>


    <!-- LÃ³gica -->
    <!-- Carga el archivo principal de JavaScript que controla toda la aplicaciÃ³n -->
    <!-- 'defer' significa que espera a que el HTML cargue antes de ejecutarse -->
    <script src="js/app.js" defer></script>
</head>
<body>

<!-- Encabezado de la pÃ¡gina (barra superior) -->
<header>
    <h1>FinCSDash</h1>
</header>

<!-- Contenido principal de la pÃ¡gina -->
<main>

<!-- LOGIN -->
<!-- SecciÃ³n de inicio de sesiÃ³n. Tiene un ID para poder ocultarla o mostrarla con JS -->
<section id="login-view">
    <h2>Login</h2>

    <!-- Campo de texto para escribir el email -->
    <input type="email" id="loginEmail" placeholder="Email">
    <!-- Contenedor para el campo de contraseÃ±a y el botÃ³n de ojo -->
    <div class="password-wrapper">
        <input type="password" id="loginPassword" placeholder="ContraseÃ±a">
        <button type="button" class="toggle-password">ğŸ‘ï¸</button>
    </div>

    <!-- BotÃ³n que al hacer clic ejecuta la funciÃ³n 'login()' de JavaScript -->
    <button onclick="login()">Ingresar</button>

    <!-- Contenedor vacÃ­o donde Google dibujarÃ¡ su botÃ³n de "Iniciar sesiÃ³n" -->
    <div id="googleBtn"></div>

    <!-- PÃ¡rrafo vacÃ­o para mostrar mensajes de error o Ã©xito -->
    <p id="loginMsg"></p>

    <!-- BotÃ³n para cambiar a la vista de registro -->
    <button onclick="showRegister()">Registrarse</button>
</section>

<!-- REGISTRO -->
<!-- SecciÃ³n de registro. 'style="display:none;"' significa que inicia oculta -->
<section id="register-view" style="display:none;">
    <h2>Registro</h2>

    <input type="email" id="registerEmail" placeholder="Email">
    <!-- Contenedor para el campo de contraseÃ±a y el botÃ³n de ojo -->
    <div class="password-wrapper">
        <input type="password" id="registerPassword" placeholder="ContraseÃ±a">
        <button type="button" class="toggle-password">ğŸ‘ï¸</button>
    </div>

    <!-- Ejecuta la funciÃ³n 'register()' al hacer clic -->
    <button onclick="register()">Registrar</button>

    <p id="registerMsg"></p>

    <!-- BotÃ³n para volver a la pantalla de login -->
    <button onclick="showLogin()">Volver</button>
</section>

<!-- VERIFICACIÃ“N -->
<!-- SecciÃ³n para ingresar el cÃ³digo que llega al correo -->
<section id="verify-view" style="display:none;">
    <h2>Verificar cuenta</h2>

    <input type="email" id="verifyEmail" placeholder="Email" readonly>
    <input type="text" id="verifyCode" placeholder="CÃ³digo">

    <!-- Ejecuta la funciÃ³n 'verify()' para validar el cÃ³digo -->
    <button onclick="verify()">Verificar</button>

    <p id="verifyMsg"></p>

    <p>Â¿No recibiste el cÃ³digo?</p>
    <button id="resendBtn" onclick="resendCode()">Reenviar cÃ³digo</button>
    <p id="resendMsg"></p>
</section>

<!-- ONBOARDING (CONFIGURACIÃ“N INICIAL) -->
<section id="onboarding-view" style="display:none;">
    <!-- Paso 1: Ingresos -->
    <div id="onboarding-step-1">
        <h2>ğŸ‘‹ Â¡Bienvenido!</h2>
        <p>Configuremos tus finanzas en 3 pasos.</p>
        
        <label class="form-label">Â¿CuÃ¡l es tu ingreso mensual aproximado?</label>
        <input type="number" id="setupIncome" placeholder="$ 0.00" class="form-control">
        
        <label class="form-label">Â¿QuÃ© dÃ­a del mes recibes tu pago?</label>
        <input type="number" id="setupPayDay" placeholder="Ej: 15" min="1" max="31" class="form-control">
        
        <button onclick="nextOnboardingStep(2)" class="btn btn-primary w-100" style="margin-top:20px;">Siguiente â¡</button>
    </div>

    <!-- Paso 2: Gastos Fijos -->
    <div id="onboarding-step-2" style="display:none;">
        <h2>ğŸ“… Gastos Fijos</h2>
        <p>Registra tus pagos recurrentes (Arriendo, Internet, etc.) y quÃ© dÃ­a debes pagarlos.</p>
        
        <div id="recurring-expenses-list">
            <!-- AquÃ­ se agregarÃ¡n los inputs dinÃ¡micamente -->
        </div>
        
        <button onclick="addRecurringRow()" class="btn btn-secondary btn-sm w-100" style="margin-bottom:15px;">ï¼‹ Agregar otro gasto</button>
        
        <div class="flex-gap">
            <button onclick="nextOnboardingStep(1)" class="btn btn-secondary">â¬… AtrÃ¡s</button>
            <button onclick="finishOnboarding()" class="btn btn-success w-100">Finalizar âœ…</button>
        </div>
    </div>

    <!-- Paso 3: Ã‰xito -->
    <div id="onboarding-step-3" style="display:none; text-align:center;">
        <h2 style="color: var(--success);">Â¡Todo listo! ğŸ‰</h2>
        <p>Hemos configurado tu perfil.</p>
        <div style="background: #e6fffa; padding: 15px; border-radius: 8px; border: 1px solid #b2f5ea; margin: 20px 0;">
            <strong>ğŸ”” Notificaciones Activadas</strong>
            <p style="font-size: 0.9rem; margin-top: 5px;">
                Te avisaremos en los dÃ­as programados para que no olvides realizar tus pagos pendientes.
            </p>
        </div>
        <p>Ahora verÃ¡s el estado real de tus finanzas.</p>
        <button onclick="completeOnboarding()" class="btn btn-primary w-100">Ir al Dashboard</button>
    </div>
</section>

<!-- DASHBOARD -->
<!-- SecciÃ³n principal del usuario, inicia oculta hasta que se loguee -->
<section id="dashboard-view" style="display:none;">
    <h2>Dashboard</h2>
    <!-- AquÃ­ se mostrarÃ¡ el correo del usuario conectado -->
    <p>Bienvenido <b id="userEmail"></b></p>
    <!-- BotÃ³n para cerrar sesiÃ³n -->
    <button onclick="logout()">Cerrar sesiÃ³n</button>
</section>

</main>

<!-- MODAL EDITAR GASTO RECURRENTE -->
<div id="edit-recurring-modal" class="modal-overlay">
    <div class="card" style="width: 350px; max-width: 90%; margin: 0;">
        <h3 style="margin-bottom: 15px;">âœï¸ Editar Pago</h3>
        <p id="editRecCategoryDisplay" class="text-muted" style="margin-bottom: 20px;"></p>
        
        <input type="hidden" id="editRecId">
        
        <label class="form-label">Nuevo Monto</label>
        <input type="number" id="editRecAmount" class="form-control form-group">
        
        <label class="form-label">DÃ­a de Pago (1-31)</label>
        <input type="number" id="editRecDay" class="form-control form-group" min="1" max="31">
        
        <div class="flex-gap">
            <button onclick="deleteRecurringExpense()" class="btn btn-danger" style="width: auto;" title="Eliminar">ğŸ—‘ï¸</button>
            <button onclick="document.getElementById('edit-recurring-modal').style.display='none'" class="btn btn-secondary">Cancelar</button>
            <button onclick="saveRecurringEdit()" class="btn btn-primary">Guardar</button>
        </div>
    </div>
</div>

</body>
</html>
